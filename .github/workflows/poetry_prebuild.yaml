name: poetry_build

on:
  workflow_call:
    inputs:
      pypi_package:
        required: true
        type: string

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Check TOML version
        id: check
        uses: ./.github/actions/check-toml
        with:
          pypi_package: ${{ inputs.pypi_package }}

      - name: Exit if not version bumped
        if: steps.check.outputs.uped_toml != 'true'
        run: echo "Version not bumped â€” skipping build" && exit 0

      - name: Install Poetry
        run: pip install poetry

      - name: Build PyPI package
        run: poetry build
